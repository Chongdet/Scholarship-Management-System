<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ - Ubon Ratchathani University</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fff;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background-color: #fff;
            padding: 15px 30px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-placeholder {
            width: 45px;
            height: 45px;
            background-color: transparent;
            border: 2px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .logo-placeholder::before,
        .logo-placeholder::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 30px;
            background-color: #999;
        }

        .logo-placeholder::before {
            transform: rotate(45deg);
        }

        .logo-placeholder::after {
            transform: rotate(-45deg);
        }

        .university-info {
            display: flex;
            flex-direction: column;
        }

        .university-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .university-name-en {
            font-size: 12px;
            color: #666;
        }

        .nav-bar {
            background-color: #e8e8e8;
            border-radius: 6px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 25px;
            flex: 1;
            margin: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex: 1;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-size: 14px;
            padding: 5px 10px;
        }

        .nav-links a:hover {
            color: #666;
        }

        .nav-links a.active {
            background-color: #d0d0d0;
            border-radius: 4px;
            font-weight: 600;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0;
        }

        .user-icon {
            width: 28px;
            height: 28px;
            background-color: transparent;
            border: 2px solid #999;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .user-icon::before {
            content: '';
            width: 10px;
            height: 10px;
            background-color: #999;
            border-radius: 50%;
            position: absolute;
            top: 4px;
        }

        .user-icon::after {
            content: '';
            width: 16px;
            height: 8px;
            border: 2px solid #999;
            border-top: none;
            border-radius: 0 0 8px 8px;
            position: absolute;
            bottom: 2px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            color: #333;
        }

        .logout-btn {
            background-color: #e8e8e8;
            border: none;
            border-radius: 6px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #333;
        }

        .logout-btn:hover {
            background-color: #d0d0d0;
        }


        /* Detail Header */
        .detail-header-section {
            background-color: #fff;
            padding: 20px 30px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail-header-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .detail-header-subtitle {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border: none;
            background-color: transparent;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Main Container */
        .main-container {
            flex: 1;
            display: flex;
            padding: 30px;
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        /* Left Panel */
        .left-panel {
            width: 350px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-card {
            background-color: #e8e8e8;
            border-radius: 8px;
            padding: 20px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 6px;
            background-color: #e0e0e0;
            color: #333;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .info-item {
            margin-bottom: 15px;
        }

        .info-item:last-child {
            margin-bottom: 0;
        }

        .info-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 15px;
            color: #333;
            font-weight: 500;
        }

        /* Middle Panel */
        .middle-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .documents-card {
            background-color: #e8e8e8;
            border-radius: 8px;
            padding: 20px;
        }

        .documents-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .documents-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .document-item {
            background-color: #fff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .document-item:last-child {
            margin-bottom: 0;
        }

        .document-icon {
            width: 40px;
            height: 40px;
            background-color: #e8e8e8;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .document-icon::before {
            content: 'üìÑ';
            font-size: 20px;
            filter: grayscale(100%);
        }

        .document-content {
            flex: 1;
        }

        .document-name {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        .document-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .document-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            border: 2px solid #ccc;
            border-radius: 4px;
            background-color: #fff;
            position: relative;
        }

        .document-checkbox input[type="checkbox"]:checked {
            background-color: #e8e8e8;
            border-color: #999;
        }

        .document-checkbox input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 12px;
            font-weight: bold;
        }

        .document-checkbox label {
            font-size: 13px;
            color: #666;
            cursor: pointer;
        }

        /* Right Panel */
        .right-panel {
            width: 500px;
            display: flex;
            flex-direction: column;
        }

        .preview-card {
            background-color: #e8e8e8;
            border-radius: 8px;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .preview-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .download-btn {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 8px 15px;
            font-size: 13px;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .download-btn:hover {
            background-color: #f0f0f0;
        }

        .download-btn span {
            filter: grayscale(100%);
        }

        .preview-content {
            background-color: #fff;
            border-radius: 8px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            min-height: 500px;
        }

        .preview-placeholder {
            text-align: center;
        }

        .preview-icon {
            width: 80px;
            height: 80px;
            background-color: #e8e8e8;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
        }

        .preview-icon::before {
            content: '';
            width: 50px;
            height: 60px;
            background-color: #fff;
            border: 2px solid #ccc;
            border-radius: 4px;
            display: block;
        }

        .preview-icon::after {
            content: '';
            position: absolute;
            width: 35px;
            height: 2px;
            background-color: #999;
            top: 35%;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 6px 0 #999, 0 12px 0 #999, 0 18px 0 #999;
        }

        .preview-text {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        /* Bottom Action Section */
        .action-section {
            background-color: #fff;
            padding: 20px 30px;
            border-top: 1px solid #e0e0e0;
        }

        .action-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .document-warning {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 6px;
            padding: 12px 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #856404;
            font-size: 14px;
        }

        .document-warning.hidden {
            display: none;
        }

        .document-warning-icon {
            font-size: 18px;
            flex-shrink: 0;
        }

        .document-warning-text {
            flex: 1;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            font-family: 'Kanit', sans-serif;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: background-color 0.2s ease;
        }

        .btn-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #fff;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .btn-icon::before {
            color: #333;
            font-size: 14px;
            font-weight: bold;
        }

        .btn-danger {
            background-color: #e8e8e8;
            color: #333;
            border: 1px solid #ccc;
        }

        .btn-danger:hover {
            background-color: #d0d0d0;
        }

        .btn-danger .btn-icon::before {
            content: '√ó';
        }

        .btn-success {
            background-color: #e8e8e8;
            color: #333;
            border: 1px solid #ccc;
        }

        .btn-success:hover {
            background-color: #d0d0d0;
        }

        .btn-success .btn-icon::before {
            content: '‚úì';
        }

        /* Footer Styles */
        .footer {
            width: 100%;
            margin-top: auto;
        }

        .footer-main {
            background-color: #f5f5f5;
            padding: 25px 30px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }

        .footer-column h3 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .footer-column p,
        .footer-column div {
            font-size: 13px;
            color: #555;
            line-height: 1.6;
            margin-bottom: 6px;
        }

        .footer-bottom {
            text-align: center;
            padding: 12px;
            background-color: #f5f5f5;
            color: #333;
            font-size: 14px;
            font-weight: 500;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background-color: #fff;
            border-radius: 12px;
            padding: 0;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background-color: transparent;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-instruction {
            font-size: 15px;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-group label .required {
            color: #666;
        }

         .form-input {
             width: 100%;
             padding: 12px 15px;
             border: 1px solid #ccc;
             border-radius: 6px;
             background-color: #f5f5f5;
             font-size: 14px;
             font-family: 'Kanit', sans-serif;
             color: #333;
         }

         .form-input:focus {
             outline: none;
             border-color: #999;
             background-color: #fff;
         }

         .form-textarea {
             width: 100%;
             min-height: 180px;
             padding: 12px 15px;
             border: 1px solid #ccc;
             border-radius: 6px;
             background-color: #f5f5f5;
             font-size: 14px;
             font-family: 'Kanit', sans-serif;
             color: #333;
             resize: vertical;
         }

         .form-textarea:focus {
             outline: none;
             border-color: #999;
             background-color: #fff;
         }

         .form-textarea::placeholder {
             color: #999;
         }


        .modal-note {
            background-color: #e8e8e8;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 30px;
        }

        .modal-note-text {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            font-family: 'Kanit', sans-serif;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .modal-btn-cancel {
            background-color: #fff;
            color: #333;
            border: 1px solid #ccc;
        }

        .modal-btn-cancel:hover {
            background-color: #f5f5f5;
        }

        .modal-btn-confirm {
            background-color: #e8e8e8;
            color: #333;
            border: 1px solid #ccc;
        }

        .modal-btn-confirm:hover {
            background-color: #d0d0d0;
        }

         /* Warning Modal Styles */
         .warning-modal {
             background-color: #fff;
             border-radius: 12px;
             padding: 0;
             max-width: 500px;
             width: 90%;
             position: relative;
         }

         .warning-icon {
             width: 60px;
             height: 60px;
             background-color: #e8e8e8;
             border-radius: 50%;
             display: flex;
             align-items: center;
             justify-content: center;
             margin: 0 auto 20px;
             font-size: 32px;
             color: #666;
             filter: grayscale(100%);
         }

         .status-indicator {
             display: inline-block;
             padding: 4px 12px;
             border-radius: 4px;
             background-color: #e8e8e8;
             color: #333;
             font-size: 13px;
             font-weight: 600;
             margin-left: 10px;
         }

         @media (max-width: 1200px) {
             .main-container {
                 flex-direction: column;
             }

             .left-panel,
             .right-panel {
                 width: 100%;
             }
         }

         @media (max-width: 1024px) {
             .nav-bar {
                 gap: 15px;
                 padding: 8px 15px;
             }
             .nav-links {
                 gap: 15px;
             }
             .nav-links a {
                 font-size: 13px;
                 padding: 4px 8px;
             }
             .user-info {
                 font-size: 13px;
             }
             .logout-btn {
                 padding: 6px 12px;
                 font-size: 13px;
             }
         }

         @media (max-width: 768px) {
             .header-top {
                 flex-direction: column;
                 gap: 15px;
             }
             .nav-bar {
                 width: 100%;
                 margin: 0;
                 flex-direction: column;
                 align-items: stretch;
                 gap: 10px;
                 padding: 10px;
             }
             .nav-links {
                 flex-direction: column;
                 align-items: stretch;
                 gap: 8px;
             }
             .nav-links a {
                 text-align: center;
                 padding: 8px;
                 background-color: #d0d0d0;
                 border-radius: 4px;
             }
             .nav-links a.active {
                 background-color: #b0b0b0;
             }
             .user-section {
                 justify-content: center;
                 margin-top: 10px;
             }
             .logout-btn {
                 width: 100%;
                 justify-content: center;
                 margin-top: 10px;
             }
             .main-container {
                 padding: 15px;
             }
             .info-card {
                 padding: 15px;
             }
             .info-row {
                 flex-direction: column;
                 gap: 10px;
             }
             .info-item {
                 width: 100%;
             }
             .documents-card {
                 padding: 15px;
             }
             .document-item {
                 padding: 12px;
             }
             .action-section {
                 padding: 15px;
             }
             .action-buttons {
                 flex-direction: column;
                 gap: 10px;
             }
             .btn {
                 width: 100%;
                 padding: 12px 20px;
                 font-size: 14px;
             }
             .modal-content {
                 width: 95%;
                 max-width: 95%;
                 padding: 20px;
             }
             .modal-buttons {
                 flex-direction: column;
             }
             .modal-btn {
                 width: 100%;
             }
         }

         @media (max-width: 480px) {
             .main-container {
                 padding: 10px;
             }
             .info-card {
                 padding: 12px;
             }
             .documents-card {
                 padding: 12px;
             }
             .document-item {
                 padding: 10px;
                 flex-direction: column;
                 gap: 10px;
             }
             .action-section {
                 padding: 12px;
             }
             .action-title {
                 font-size: 14px;
             }
             .document-warning {
                 padding: 10px;
                 font-size: 13px;
             }
             .modal-content {
                 padding: 15px;
             }
         }
     </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="logo-section">
                <div class="logo-placeholder"></div>
                <div class="university-info">
                    <div class="university-name">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
                    <div class="university-name-en">Ubon Ratchathani University</div>
                </div>
            </div>
            <div class="nav-bar">
                <nav class="nav-links">
                    <a href="{{ url_for('officer.verify_application') }}" class="active">
                        ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
                    </a>
                </nav>
                <div class="user-section">
                    <div class="user-icon"></div>
                    <div class="user-info">
                        <span id="usernameDisplay">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</span>
                    </div>
                </div>
                <button class="logout-btn" onclick="window.location.href='index.html'">
                    <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Detail Header -->
    <div class="detail-header-section">
        <div>
            <div class="detail-header-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ - <span id="studentNameHeader">-</span></div>
            <div class="detail-header-subtitle">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span id="studentIdHeader">-</span></div>
        </div>
        <a href="{{ url_for('officer.verify_application') }}" class="close-btn">√ó</a>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel -->
        <div class="left-panel">
            <!-- Current Status -->
            <div class="info-card">
                <div class="card-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                <span class="status-badge" id="statusBadge">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
            </div>

            <!-- Personal Information -->
            <div class="info-card">
                <div class="card-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>
                <div class="info-item">
                    <div class="info-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
                    <div class="info-value" id="studentName">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">‡∏Ñ‡∏ì‡∏∞</div>
                    <div class="info-value" id="faculty">‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</div>
                </div>
                <div class="info-item">
                    <div class="info-label">GPAX</div>
                    <div class="info-value" id="gpax">3.75</div>
                </div>
                <div class="info-item">
                    <div class="info-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
                    <div class="info-value" id="phone">081-234-5678</div>
                </div>
                <div class="info-item">
                    <div class="info-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
                    <div class="info-value" id="email">somchai.j@email.com</div>
                </div>
            </div>

            <!-- Scholarship Information -->
            <div class="info-card">
                <div class="card-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
                <div class="info-item">
                    <div class="info-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏∏‡∏ô</div>
                    <div class="info-value" id="scholarshipName">‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2568</div>
                </div>
                <div class="info-item">
                    <div class="info-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
                    <div class="info-value" id="applyDate">2 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2569</div>
                </div>
            </div>
        </div>

        <!-- Middle Panel -->
        <div class="middle-panel">
            <div class="documents-card">
                <div class="documents-header">
                    <div class="documents-title">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (<span id="docCount">3</span>)</div>
                </div>
                <div class="document-item" onclick="showPreview('‡πÉ‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô')">
                    <div class="document-icon"></div>
                    <div class="document-content">
                        <div class="document-name">‡πÉ‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                        <div class="document-checkbox">
                            <input type="checkbox" id="doc1" checked>
                            <label for="doc1">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</label>
                        </div>
                    </div>
                </div>
                <div class="document-item" onclick="showPreview('‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô')">
                    <div class="document-icon"></div>
                    <div class="document-content">
                        <div class="document-name">‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</div>
                        <div class="document-checkbox">
                            <input type="checkbox" id="doc2" checked>
                            <label for="doc2">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</label>
                        </div>
                    </div>
                </div>
                <div class="document-item" onclick="showPreview('‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô')">
                    <div class="document-icon"></div>
                    <div class="document-content">
                        <div class="document-name">‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô</div>
                        <div class="document-checkbox">
                            <input type="checkbox" id="doc3" checked>
                            <label for="doc3">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <div class="preview-card">
                <div class="preview-header">
                    <div class="preview-title" id="previewTitle">‡πÉ‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                    <button class="download-btn">
                        <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</span>
                    </button>
                </div>
                <div class="preview-content">
                    <div class="preview-placeholder">
                        <div class="preview-icon"></div>
                        <div class="preview-text">
                            ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ PDF: <span id="previewDocName">‡πÉ‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span><br>
                            (‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á PDF Viewer ‡πÅ‡∏ö‡∏ö Inline)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Action Section -->
    <div class="action-section">
        <div class="action-title">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
        <div class="document-warning" id="documentWarning">
            <span class="document-warning-icon">‚ö†Ô∏è</span>
            <span class="document-warning-text">
                <strong>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</strong> ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£
            </span>
        </div>
        <div class="action-buttons" id="actionButtons">
            <button class="btn btn-danger" id="rejectBtn" onclick="rejectApplication()">
                <div class="btn-icon"></div>
                <span>‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</span>
            </button>
            <button class="btn btn-success" id="approveBtn" onclick="approveApplication()">
                <div class="btn-icon"></div>
                <span>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</span>
            </button>
            <button class="btn btn-success" id="markPassedBtn" onclick="markAsPassed()" style="display: none;">
                <div class="btn-icon"></div>
                <span>‚úì ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span>
            </button>
        </div>
    </div>

    <!-- Reject Modal -->
    <div class="modal-overlay" id="rejectModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</div>
                <button class="modal-close" onclick="closeRejectModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-instruction">
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á <span id="rejectStudentName">-</span>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò <span class="required">*</span></label>
                    <textarea 
                        id="rejectReason" 
                        class="form-textarea" 
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô, GPAX ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á..."
                        required
                    ></textarea>
                </div>
                <div class="modal-note">
                    <div class="modal-note-text">
                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-cancel" onclick="closeRejectModal()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="modal-btn modal-btn-confirm" onclick="confirmReject()">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Reject Modal -->
    <div class="modal-overlay" id="confirmRejectModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</div>
                <button class="modal-close" onclick="closeConfirmRejectModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-instruction">
                    ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
                </div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-cancel" onclick="closeConfirmRejectModal()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="modal-btn modal-btn-confirm" onclick="finalConfirmReject()">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reject Success Modal -->
    <div class="modal-overlay" id="rejectSuccessModal">
        <div class="modal-content">
            <div class="modal-body" style="text-align: center; padding: 50px 30px;">
                <div style="font-size: 48px; margin-bottom: 20px; color: #666; filter: grayscale(100%);">‚úì</div>
                <div class="modal-title" style="margin-bottom: 15px;">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                <div class="modal-instruction" style="margin-bottom: 30px;">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                </div>
                <div class="modal-buttons" style="justify-content: center;">
                    <button class="modal-btn modal-btn-confirm" onclick="closeRejectSuccessModal()">
                        ‡∏ï‡∏Å‡∏•‡∏á
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Approve Modal -->
    <div class="modal-overlay" id="approveModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</div>
                <button class="modal-close" onclick="closeApproveModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-instruction">
                    ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö <span id="approveStudentName">-</span>
                </div>
                <div class="form-group">
                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå <span class="required">*</span></label>
                    <input 
                        type="date" 
                        id="interviewDate" 
                        class="form-input" 
                        required
                    >
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏ß‡∏•‡∏≤ <span class="required">*</span></label>
                    <input 
                        type="time" 
                        id="interviewTime" 
                        class="form-input" 
                        required
                    >
                </div>
                <div class="form-group">
                    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà <span class="required">*</span></label>
                    <textarea 
                        id="interviewLocation" 
                        class="form-textarea" 
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô 3"
                        required
                    ></textarea>
                </div>
                <div class="modal-note">
                    <div class="modal-note-text">
                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå" ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-cancel" onclick="closeApproveModal()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="modal-btn modal-btn-confirm" onclick="confirmApprove()">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Approve Modal -->
    <div class="modal-overlay" id="confirmApproveModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                <button class="modal-close" onclick="closeConfirmApproveModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-instruction">
                    ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
                </div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-cancel" onclick="closeConfirmApproveModal()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="modal-btn modal-btn-confirm" onclick="finalConfirmApprove()">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                    </button>
                </div>
            </div>
        </div>
    </div>

     <!-- Approve Success Modal -->
     <div class="modal-overlay" id="approveSuccessModal">
         <div class="modal-content">
             <div class="modal-body" style="text-align: center; padding: 50px 30px;">
                 <div style="font-size: 48px; margin-bottom: 20px; color: #666; filter: grayscale(100%);">‚úì</div>
                 <div class="modal-title" style="margin-bottom: 15px;">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                 <div class="modal-instruction" style="margin-bottom: 30px;">
                     ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå" ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                 </div>
                 <div class="modal-buttons" style="justify-content: center;">
                     <button class="modal-btn modal-btn-confirm" onclick="closeApproveSuccessModal()">
                         ‡∏ï‡∏Å‡∏•‡∏á
                     </button>
                 </div>
             </div>
         </div>
     </div>

     <!-- Warning Modal - Another staff is reviewing -->
     <div class="modal-overlay" id="warningModal">
         <div class="warning-modal">
             <div class="modal-body" style="text-align: center; padding: 40px 30px;">
                 <div class="warning-icon">‚ö†</div>
                 <div class="modal-title" style="margin-bottom: 15px;">‡∏°‡∏µ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¢‡∏π‡πà</div>
                 <div class="modal-instruction" style="margin-bottom: 30px;">
                     <p style="margin-bottom: 10px;">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà <strong id="reviewingStaffName">-</strong> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà</p>
                     <p style="font-size: 13px; color: #666;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô</p>
                 </div>
                 <div class="modal-buttons" style="justify-content: center;">
                     <button class="modal-btn modal-btn-confirm" onclick="closeWarningModal()">
                         ‡∏ï‡∏Å‡∏•‡∏á
                     </button>
                 </div>
             </div>
         </div>
     </div>

     <script>
         // Get application data from URL parameters
         const urlParams = new URLSearchParams(window.location.search);
         const appId = urlParams.get('id') || '';
         const studentId = urlParams.get('studentId') || '';
         const studentName = urlParams.get('name') || '';
         const status = urlParams.get('status') || '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
         
         // Current staff (in real app, get from login session)
         const currentStaffId = 'staff_' + Date.now(); // Unique ID for current session
         const username = sessionStorage.getItem('currentUsername');
         const currentStaffName = username ? `${username} (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)` : '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà';
         
         // Check interval for concurrent review detection
         let checkInterval = null;

        // ============================================
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á (Sample Data) - ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö localStorage
        // ============================================
        
        // Helper function to build full scholarship name (same as applications.html)
        function buildFullScholarshipName(scholarship) {
            let baseName = scholarship.name || '';
            
            if (baseName.includes('‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤')) {
                const nameMatch = baseName.match(/‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤\s*"([^"]+)"/);
                if (nameMatch) {
                    baseName = nameMatch[1];
                } else {
                    const nameMatch2 = baseName.match(/‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤\s+(.+?)(?:\s+‡∏à‡∏≥‡∏ô‡∏ß‡∏ô|$)/);
                    if (nameMatch2) {
                        baseName = nameMatch2[1].trim();
                    }
                }
            }
            
            if (scholarship.details) {
                const detailsText = scholarship.details.trim();
                const numberOfScholarshipsMatch = detailsText.match(/‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏∏‡∏ô\s*:\s*([^\n]+)/);
                const amountMatch = detailsText.match(/‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏•‡∏∞\s*:\s*([^\n]+)/);
                
                if (numberOfScholarshipsMatch && amountMatch) {
                    return `‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ "${baseName}" ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${numberOfScholarshipsMatch[1].trim()} ‡πÜ ‡∏•‡∏∞ ${amountMatch[1].trim()}`;
                }
            }
            
            return baseName || scholarship.name;
        }
        
        // Function to get application data from localStorage only
        function getMergedApplicationData(studentId) {
            // Get real data from localStorage only
            const realApplications = JSON.parse(localStorage.getItem('applications') || '[]');
            const realStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
            
            // Find application by studentId
            const realApp = realApplications.find(app => app.studentId === studentId);
            if (realApp) {
                const status = realStatuses[studentId] || realApp.status || '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                return {
                    name: realApp.name,
                    faculty: realApp.faculty,
                    gpax: realApp.gpa,
                    phone: realApp.phone || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                    email: realApp.email || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                    applyDate: realApp.applicationDate || realApp.createdAt || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                    scholarshipName: realApp.scholarshipName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',
                    status: status
                };
            }
            
            // Return null if not found
            return null;
        }
        
        // Legacy applicationData for backward compatibility (deprecated - use getMergedApplicationData)
        const applicationData = {};

         // Function to check if another staff is reviewing this application
         function checkConcurrentReview() {
             const reviewingData = JSON.parse(localStorage.getItem('reviewingApplications') || '{}');
             const reviewKey = `app_${studentId}`;
             const currentReview = reviewingData[reviewKey];
             
             // Check if someone else is reviewing
             if (currentReview && currentReview.staffId !== currentStaffId) {
                 // Check if review is still active (within last 30 seconds)
                 const timeDiff = Date.now() - currentReview.timestamp;
                 if (timeDiff < 30000) { // 30 seconds timeout
                     document.getElementById('reviewingStaffName').textContent = currentReview.staffName;
                     document.getElementById('warningModal').classList.add('show');
                     return false;
                 } else {
                     // Remove stale review data
                     delete reviewingData[reviewKey];
                     localStorage.setItem('reviewingApplications', JSON.stringify(reviewingData));
                 }
             }
             return true;
         }
         
         // Function to start reviewing (mark as "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö")
         function startReviewing() {
             if (!checkConcurrentReview()) {
                 return false; // Another staff is reviewing
             }
             
             const reviewingData = JSON.parse(localStorage.getItem('reviewingApplications') || '{}');
             const reviewKey = `app_${studentId}`;
             
             reviewingData[reviewKey] = {
                 staffId: currentStaffId,
                 staffName: currentStaffName,
                 studentId: studentId,
                 studentName: studentName,
                 timestamp: Date.now()
             };
             
             localStorage.setItem('reviewingApplications', JSON.stringify(reviewingData));
             
             // Update status to "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"
             document.getElementById('statusBadge').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
             
             // Save status to localStorage for applications.html to read
             const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
             applicationStatuses[studentId] = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
             localStorage.setItem('applicationStatuses', JSON.stringify(applicationStatuses));
             
             // Start periodic check for concurrent reviews
             checkInterval = setInterval(() => {
                 checkConcurrentReview();
             }, 3000); // Check every 3 seconds
             
             return true;
         }
         
         // Function to stop reviewing (when leaving page)
         function stopReviewing() {
             const reviewingData = JSON.parse(localStorage.getItem('reviewingApplications') || '{}');
             const reviewKey = `app_${studentId}`;
             
             if (reviewingData[reviewKey] && reviewingData[reviewKey].staffId === currentStaffId) {
                 // Change status back to "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö" if it was "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"
                 const currentStatus = document.getElementById('statusBadge').textContent;
                 if (currentStatus === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö') {
                     // Update status badge
                     document.getElementById('statusBadge').textContent = '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                     
                     // Save status to localStorage for applications.html to read
                     const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
                     applicationStatuses[studentId] = '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                     localStorage.setItem('applicationStatuses', JSON.stringify(applicationStatuses));
                 }
                 
                 // Remove reviewing data
                 delete reviewingData[reviewKey];
                 localStorage.setItem('reviewingApplications', JSON.stringify(reviewingData));
             }
             
             if (checkInterval) {
                 clearInterval(checkInterval);
                 checkInterval = null;
             }
         }
         
         // Function to close warning modal
         function closeWarningModal() {
            document.getElementById('warningModal').classList.remove('show');
            // Redirect back to applications list
            setTimeout(() => {
                stopReviewing();
                window.location.href = "{{ url_for('officer.verify_application') }}";
            }, 500);
         }

         // Update page with application data (merged from localStorage + sample data)
         const mergedData = getMergedApplicationData(studentId);
         if (mergedData) {
             document.getElementById('studentNameHeader').textContent = mergedData.name;
             document.getElementById('studentIdHeader').textContent = studentId;
             document.getElementById('studentName').textContent = mergedData.name;
             document.getElementById('faculty').textContent = mergedData.faculty;
             document.getElementById('gpax').textContent = mergedData.gpax;
             document.getElementById('phone').textContent = mergedData.phone;
             document.getElementById('email').textContent = mergedData.email;
             document.getElementById('applyDate').textContent = mergedData.applyDate;
             document.getElementById('scholarshipName').textContent = mergedData.scholarshipName;
             document.getElementById('statusBadge').textContent = mergedData.status;
         } else {
             // If not found, use URL parameters or defaults
             document.getElementById('studentNameHeader').textContent = studentName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
             document.getElementById('studentIdHeader').textContent = studentId;
             document.getElementById('studentName').textContent = studentName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
             document.getElementById('statusBadge').textContent = status || '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
         }
         
        // Initialize review tracking when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load username from sessionStorage
            const username = sessionStorage.getItem('currentUsername');
            if (username) {
                const usernameDisplay = document.getElementById('usernameDisplay');
                if (usernameDisplay) {
                    usernameDisplay.textContent = `${username} (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)`;
                }
            }
            
            // Add event listeners to document checkboxes to update button states
            const docCheckboxes = document.querySelectorAll('.document-checkbox input[type="checkbox"]');
            docCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateActionButtonsState();
                });
            });
            
            // Load status from localStorage to ensure it's current
            const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
            const currentStatusFromStorage = applicationStatuses[studentId];
            if (currentStatusFromStorage) {
                document.getElementById('statusBadge').textContent = currentStatusFromStorage;
            }
            
            // Initialize button states
            updateActionButtonsState();
            
            // Check if another staff is already reviewing
            if (!checkConcurrentReview()) {
                return; // Warning modal will be shown
            }
            
            // Start reviewing if status is "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"
            const currentStatus = document.getElementById('statusBadge').textContent;
            if (currentStatus === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö') {
                startReviewing();
            }
        });
         
         // Clean up when leaving page
         window.addEventListener('beforeunload', function() {
             stopReviewing();
         });
         
         // Also clean up when clicking close button
         const closeBtn = document.querySelector('.close-btn');
         if (closeBtn) {
             closeBtn.addEventListener('click', function() {
                 stopReviewing();
             });
         }

        function showPreview(docName) {
            document.getElementById('previewTitle').textContent = docName;
            document.getElementById('previewDocName').textContent = docName;
        }

        // Function to check if all documents are reviewed
        function areAllDocumentsReviewed() {
            const docCheckboxes = document.querySelectorAll('.document-checkbox input[type="checkbox"]');
            let allReviewed = true;
            
            docCheckboxes.forEach(checkbox => {
                if (!checkbox.checked) {
                    allReviewed = false;
                }
            });
            
            return allReviewed && docCheckboxes.length > 0;
        }

        // Check if current user is committee member (‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£) or staff (‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà)
        // In real system, this should come from login/session data
        function isCommitteeMember() {
            const userRole = sessionStorage.getItem('userRole') || 'staff'; // Default to 'staff'
            return userRole === 'committee' || userRole === '‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£';
        }
        
        // Function to update button states based on document review status and current status
        function updateActionButtonsState() {
            const allReviewed = areAllDocumentsReviewed();
            const rejectBtn = document.getElementById('rejectBtn');
            const approveBtn = document.getElementById('approveBtn');
            const markPassedBtn = document.getElementById('markPassedBtn');
            const warning = document.getElementById('documentWarning');
            const currentStatus = document.getElementById('statusBadge').textContent;
            const isCommittee = isCommitteeMember(); // Check if user is committee member
            
            // Show/hide buttons based on current status and user role
            if (currentStatus === '‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå') {
                // If status is "‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå", only committee can mark as "‡∏ú‡πà‡∏≤‡∏ô"
                if (rejectBtn) rejectBtn.style.display = 'none';
                if (approveBtn) approveBtn.style.display = 'none';
                if (markPassedBtn) {
                    // Only show "‡∏ú‡πà‡∏≤‡∏ô" button if user is committee member
                    markPassedBtn.style.display = isCommittee ? 'flex' : 'none';
                }
                if (warning) warning.classList.add('hidden');
            } else if (currentStatus === '‡∏ú‡πà‡∏≤‡∏ô' || currentStatus === '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤') {
                // If already passed, hide all action buttons
                if (rejectBtn) rejectBtn.style.display = 'none';
                if (approveBtn) approveBtn.style.display = 'none';
                if (markPassedBtn) markPassedBtn.style.display = 'none';
                if (warning) warning.classList.add('hidden');
            } else {
                // For other statuses (‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö, ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö), staff can reject or approve for interview
                if (rejectBtn) rejectBtn.style.display = 'flex';
                if (approveBtn) approveBtn.style.display = 'flex';
                if (markPassedBtn) markPassedBtn.style.display = 'none';
                
                if (allReviewed) {
                    if (rejectBtn) rejectBtn.disabled = false;
                    if (approveBtn) approveBtn.disabled = false;
                    if (warning) {
                        warning.classList.add('hidden');
                    }
                } else {
                    if (rejectBtn) rejectBtn.disabled = true;
                    if (approveBtn) approveBtn.disabled = true;
                    if (warning) {
                        warning.classList.remove('hidden');
                    }
                }
            }
        }
        
        // Function to mark application as passed (after interview)
        function markAsPassed() {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                return;
            }
            
            const studentId = urlParams.get('id') || studentId;
            const studentName = document.getElementById('studentName').textContent;
            const appId = urlParams.get('id') || '';
            const staffName = currentStaffName || '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà';
            
            // Update status to "‡∏ú‡πà‡∏≤‡∏ô"
            const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
            applicationStatuses[studentId] = '‡∏ú‡πà‡∏≤‡∏ô';
            localStorage.setItem('applicationStatuses', JSON.stringify(applicationStatuses));
            
            // Also update in applications array (only if exists in localStorage)
            // Note: Sample data applications will be saved to localStorage when status changes
            const applications = JSON.parse(localStorage.getItem('applications') || '[]');
            let appIndex = applications.findIndex(app => app.studentId === studentId);
            
            if (appIndex !== -1) {
                applications[appIndex].status = '‡∏ú‡πà‡∏≤‡∏ô';
                localStorage.setItem('applications', JSON.stringify(applications));
            } else {
                // If sample data application, save it to localStorage now
                const mergedData = getMergedApplicationData(studentId);
                if (mergedData) {
                    const newApplication = {
                        studentId: studentId,
                        name: mergedData.name,
                        faculty: mergedData.faculty,
                        gpa: mergedData.gpax,
                        phone: mergedData.phone,
                        email: mergedData.email,
                        applicationDate: mergedData.applyDate,
                        scholarshipName: mergedData.scholarshipName,
                        status: '‡∏ú‡πà‡∏≤‡∏ô',
                        createdAt: new Date().toISOString()
                    };
                    applications.push(newApplication);
                    localStorage.setItem('applications', JSON.stringify(applications));
                }
            }
            
            // Update status badge on page
            document.getElementById('statusBadge').textContent = '‡∏ú‡πà‡∏≤‡∏ô';
            
            // Log activity
            const now = new Date();
            const formattedDateTime = now.toLocaleDateString('th-TH', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            const formattedTime = now.toLocaleTimeString('th-TH', {
                hour: '2-digit',
                minute: '2-digit'
            });
            const activity = {
                actionType: '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',
                appId: appId,
                description: `‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ ${studentName} (‡∏£‡∏´‡∏±‡∏™: ${studentId}) ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤`,
                staffName: staffName,
                dateTime: `${formattedDateTime} ‡πÄ‡∏ß‡∏•‡∏≤ ${formattedTime}`,
                timestamp: now.getTime()
            };
            const activities = JSON.parse(localStorage.getItem('activities') || '[]');
            activities.unshift(activity);
            if (activities.length > 50) activities.splice(50);
            localStorage.setItem('activities', JSON.stringify(activities));
            
            // Stop reviewing
            stopReviewing();
            
            // Update button states
            updateActionButtonsState();
            
            // Show success message
            alert('‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß\n\n‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®" ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥');
            
            // Trigger storage event to notify other pages
            window.dispatchEvent(new Event('storage'));
        }

        function approveApplication() {
            // Check if all documents are reviewed
            if (!areAllDocumentsReviewed()) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£');
                return;
            }

            // Update student name in modal
            const studentName = document.getElementById('studentName').textContent;
            document.getElementById('approveStudentName').textContent = studentName;
            // Clear previous data
            document.getElementById('interviewDate').value = '';
            document.getElementById('interviewTime').value = '';
            document.getElementById('interviewLocation').value = '';
            // Show modal
            document.getElementById('approveModal').classList.add('show');
        }

        function closeApproveModal() {
            document.getElementById('approveModal').classList.remove('show');
        }

        function confirmApprove() {
            const date = document.getElementById('interviewDate').value;
            const time = document.getElementById('interviewTime').value;
            const location = document.getElementById('interviewLocation').value.trim();

            if (!date || !time || !location) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }

            // Close approve modal and show confirmation modal
            closeApproveModal();
            document.getElementById('confirmApproveModal').classList.add('show');
        }

        function closeConfirmApproveModal() {
            document.getElementById('confirmApproveModal').classList.remove('show');
        }

         function finalConfirmApprove() {
             // Check if another staff started reviewing
             if (!checkConcurrentReview()) {
                 closeConfirmApproveModal();
                 return;
             }
             
             const date = document.getElementById('interviewDate').value;
             const time = document.getElementById('interviewTime').value;
             const location = document.getElementById('interviewLocation').value.trim();
             const studentName = document.getElementById('studentName').textContent;
             const appId = urlParams.get('id') || '';
             const staffName = currentStaffName;

             // Format date
             const dateObj = new Date(date);
             const formattedDate = dateObj.toLocaleDateString('th-TH', {
                 year: 'numeric',
                 month: 'long',
                 day: 'numeric'
             });

             // Log activity
             if (typeof logActivity === 'function') {
                 logActivity('‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå', appId, `‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formattedDate} ‡πÄ‡∏ß‡∏•‡∏≤ ${time} ‡∏ô. ‡∏ì ${location}`, staffName);
             } else {
                 // Save to localStorage if logActivity is not available
                 const now = new Date();
                 const formattedDateTime = now.toLocaleDateString('th-TH', {
                     year: 'numeric',
                     month: 'long',
                     day: 'numeric'
                 });
                 const formattedTime = now.toLocaleTimeString('th-TH', {
                     hour: '2-digit',
                     minute: '2-digit'
                 });
                 const activity = {
                     actionType: '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå',
                     appId: appId,
                     description: `‡∏ô‡∏±‡∏î‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formattedDate} ‡πÄ‡∏ß‡∏•‡∏≤ ${time} ‡∏ô. ‡∏ì ${location}`,
                     staffName: staffName,
                     dateTime: `${formattedDateTime} ‡πÄ‡∏ß‡∏•‡∏≤ ${formattedTime}`,
                     timestamp: now.getTime()
                 };
                const activities = JSON.parse(localStorage.getItem('activities') || '[]');
                activities.unshift(activity);
                if (activities.length > 50) activities.splice(50);
                localStorage.setItem('activities', JSON.stringify(activities));
            }
            
            // Update status to "‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"
            const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
            applicationStatuses[studentId] = '‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå';
            localStorage.setItem('applicationStatuses', JSON.stringify(applicationStatuses));
            
            // Update status badge on page
            document.getElementById('statusBadge').textContent = '‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå';
            
            // Stop reviewing
            stopReviewing();

             // Close confirmation modal
             closeConfirmApproveModal();

             // Show success modal
             document.getElementById('approveSuccessModal').classList.add('show');
         }

        function closeApproveSuccessModal() {
            document.getElementById('approveSuccessModal').classList.remove('show');
            window.location.href = "{{ url_for('officer.verify_application') }}";
        }

        function rejectApplication() {
            // Check if all documents are reviewed
            if (!areAllDocumentsReviewed()) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£');
                return;
            }

            // Update student name in modal
            const studentName = document.getElementById('studentName').textContent;
            document.getElementById('rejectStudentName').textContent = studentName;
            // Clear previous reason
            document.getElementById('rejectReason').value = '';
            // Show modal
            document.getElementById('rejectModal').classList.add('show');
        }

        function closeRejectModal() {
            document.getElementById('rejectModal').classList.remove('show');
        }

        function confirmReject() {
            const reason = document.getElementById('rejectReason').value.trim();
            if (!reason) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò');
                return;
            }
            
            // Close reject modal and show confirmation modal
            closeRejectModal();
            document.getElementById('confirmRejectModal').classList.add('show');
        }

        function closeConfirmRejectModal() {
            document.getElementById('confirmRejectModal').classList.remove('show');
        }

         function finalConfirmReject() {
             // Check if another staff started reviewing
             if (!checkConcurrentReview()) {
                 closeConfirmRejectModal();
                 return;
             }
             
             const reason = document.getElementById('rejectReason').value.trim();
             const studentName = document.getElementById('studentName').textContent;
             const appId = urlParams.get('id') || '';
             const staffName = currentStaffName;

             // Log activity
             if (typeof logActivity === 'function') {
                 logActivity('‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò', appId, `‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡∏≠‡∏á ${studentName} ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ${reason}`, staffName);
             } else {
                 // Save to localStorage if logActivity is not available
                 const now = new Date();
                 const formattedDate = now.toLocaleDateString('th-TH', {
                     year: 'numeric',
                     month: 'long',
                     day: 'numeric'
                 });
                 const formattedTime = now.toLocaleTimeString('th-TH', {
                     hour: '2-digit',
                     minute: '2-digit'
                 });
                 const activity = {
                     actionType: '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò',
                     appId: appId,
                     description: `‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡∏≠‡∏á ${studentName} ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ${reason}`,
                     staffName: staffName,
                     dateTime: `${formattedDate} ‡πÄ‡∏ß‡∏•‡∏≤ ${formattedTime}`,
                     timestamp: now.getTime()
                 };
                const activities = JSON.parse(localStorage.getItem('activities') || '[]');
                activities.unshift(activity);
                if (activities.length > 50) activities.splice(50);
                localStorage.setItem('activities', JSON.stringify(activities));
            }
            
            // Update status to "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò" and remove from review system
            const applicationStatuses = JSON.parse(localStorage.getItem('applicationStatuses') || '{}');
            applicationStatuses[studentId] = '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò';
            localStorage.setItem('applicationStatuses', JSON.stringify(applicationStatuses));
            
            // Remove from reviewing applications (if still being reviewed)
            const reviewingData = JSON.parse(localStorage.getItem('reviewingApplications') || '{}');
            const reviewKey = `app_${studentId}`;
            if (reviewingData[reviewKey]) {
                delete reviewingData[reviewKey];
                localStorage.setItem('reviewingApplications', JSON.stringify(reviewingData));
            }
            
            // Update status badge on page
            document.getElementById('statusBadge').textContent = '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò';
            
            // Stop reviewing
            stopReviewing();

             // Close confirmation modal
             closeConfirmRejectModal();

             // Show success modal
             document.getElementById('rejectSuccessModal').classList.add('show');
         }

        function closeRejectSuccessModal() {
            document.getElementById('rejectSuccessModal').classList.remove('show');
            window.location.href = "{{ url_for('officer.verify_application') }}";
        }

        // Close modal when clicking outside
        document.addEventListener('DOMContentLoaded', function() {
            const rejectModal = document.getElementById('rejectModal');
            if (rejectModal) {
                rejectModal.addEventListener('click', function(e) {
                    if (e.target === rejectModal) {
                        closeRejectModal();
                    }
                });
            }

            const confirmModal = document.getElementById('confirmRejectModal');
            if (confirmModal) {
                confirmModal.addEventListener('click', function(e) {
                    if (e.target === confirmModal) {
                        closeConfirmRejectModal();
                    }
                });
            }

            const approveModal = document.getElementById('approveModal');
            if (approveModal) {
                approveModal.addEventListener('click', function(e) {
                    if (e.target === approveModal) {
                        closeApproveModal();
                    }
                });
            }

            const confirmApproveModal = document.getElementById('confirmApproveModal');
            if (confirmApproveModal) {
                confirmApproveModal.addEventListener('click', function(e) {
                    if (e.target === confirmApproveModal) {
                        closeConfirmApproveModal();
                    }
                });
            }
        });
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-main">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h3>
                    <p>‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</p>
                    <p>85 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏ñ‡∏•‡∏°‡∏≤‡∏£‡πå‡∏Ñ ‡∏ï‡∏≥‡∏ö‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡πÑ‡∏Ñ</p>
                    <p>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ß‡∏≤‡∏£‡∏¥‡∏ô‡∏ä‡∏≥‡∏£‡∏≤‡∏ö</p>
                    <p>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ 34190</p>
                </div>
                <div class="footer-column">
                    <h3>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
                    <p>Email: ubustudent.d@ubu.ac.th</p>
                    <p>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå: 045-353000 ‡∏ï‡πà‡∏≠ 1210</p>
                </div>
                <div class="footer-column">
                    <h3>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</h3>
                    <p>Facebook</p>
                    <p>Website</p>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            Ubon Ratchathani University ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ
        </div>
    </footer>
</body>
</html>

